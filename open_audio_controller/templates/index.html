<!DOCTYPE html>
<html>

<head>
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
   
    <div id="content">
        <img src="static/IBMlogo.png" class="center" > 
        <br> 
        <br>      
        <button class = "centered" onclick="activationButton(event)">Activate Noise Cancellation</button>
         
    </div>
    <div id="my_dataviz"></div>

    <script type="text/javascript">
        let controllerState = false;
        async function activationButton(ev) {
            ev.preventDefault()
            
            if (controllerState) {
                ev.target.innerText = 'Activate Noise Cancellation'
                controllerState = false;
            } else {
                ev.target.innerText = 'Deactivate Noise Cancellation'
                controllerState = true;
            }
            post("{{url_for('controller_state')}}", ({state: controllerState}))
        }

        async function post(route, data) {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', route)
            xhr.setRequestHeader("Content-Type", "application/json")
            xhr.send(JSON.stringify(data))
        }
        async function get(route){
            var xhr = new XMLHttpRequest();
            xhr.open('GET', route)
            xhr.send()
            xhr.onload = function(){
                return data
            }
            
        }
    </script>
    <script src="https://d3js.org/d3.v6.min.js">
        async function draw_graph(){
            var margin = {top: 200,
                        right: 30,
                        bottom: 30,
                        left: 60},
            width = 460 - margin.left - margin.right,
            height = 400 - margin.top - margin.bottom;
            var svg = d3.select("#my_dataviz")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform",
            "translate(" + margin.left + "," + margin.top + ")");
            d3.csv(get("{{url_for('spectrum')}}"))


        
    }
    </script>
</body>

</html>